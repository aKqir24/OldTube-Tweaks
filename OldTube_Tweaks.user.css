/* ==UserStyle==
@name           OldTube Tweaks (Cleaned)
@author         aKqir24 <Akqir> (https://github.com/aKqir24)
@description    Interface tweaks for a nostalgic YouTube experience (cleaned and deduplicated)
@namespace      https://userstyles.world/user/aKqir24
@homepageURL    https://github.com/aKqir24/OldTube-Tweaks
@supportURL     https://github.com/aKqir24/OldTube-Tweaks/issues
@version        1.3.3
@license        MIT
@preprocessor   stylus

@var number descriptionRadius "Panels Radius" [0, 0, 20, 5, "px"]
@var number feedVideoRadius "Video Radius" [0, 0, 20, 5, "px"]
@var number buttonRadius "Buttons Radius" [0, 0, 20, 5, "px"]
@var number searchBoxRadius "Searchbox Radius" [0, 0, 20, 5, "px"]
@var range videoCardThumbnail "Video Margins" [1, 0, 10, 1, "px"]

@var checkbox controlShadow 'Controls Shadow' 1
@var checkbox removeShorts  'Remove Shorts' 1
@var checkbox compactMenu   'Compact Menu' 1
@var checkbox betaFeatures  'Beta Features' 0
@var color ytbgColor 'Bg Color (beta)' #000

@var select accentChoice "Theme Color Level" [ "None:None",
                                          "Mini:Minimal",
                                          "Full:Full*" ]
@var color accentColor1 'Primary Color' #CC0000
@var color accentColor2 'Secondary Color' #f03
==/UserStyle== */

@-moz-document domain("youtube.com") {
  :root {
    --sub-white-text-btn: #f2f2f2;
    --button-corner-radius: buttonRadius;
    --search-box-color: var(--yt-spec-call-to-action);
    --corner-radius-video-player: feedVideoRadius;
    --description-corner: descriptionRadius;
    --feed-thumbnail-preview: feedVideoRadius;
    --video-card-preview: videoCardThumbnail;
    --search-box-radius: searchBoxRadius;
    --progressbar-color-right: #ff2791;
    --progressbar-color-left: #f03;
    --highlight-link: #2091f0;
    --button-des-text: #2091f0;
    --dislike-color: red;
    --like-color: lime;
  }

  /** Accent Color Application */
  if accentChoice == Full {
    :root {
      --subscribe-button-color: accentColor1;
      --progressbar-color-left: accentColor1;
      --progressbar-color-right: accentColor2;
      --yt-attributed-string-link-hover-color: accentColor2;
      --button-des-text: accentColor1;
      --search-box-color: accentColor1;
    }
    html[dark], [dark] { --yt-spec-red-indicator: accentColor1 }
  } else if accentChoice == Mini {
    :root {
      --search-box-color: accentColor1;
      --subscribe-button-color: accentColor1;
      --playlist-progressbar-color: linear-gradient(to right, var(accentColor1) 80%, var(accentColor2) 100%);
    }
  } else if accentChoice == None {
    :root { --playlist-progress-color: linear-gradient(to right, #f03 80%, #ff2791 100%); }
    html[dark], [dark] { --yt-spec-red-indicator: linear-gradient(to right, #f03 80%, #ff2791 100%); }
  }

  /** Controls Shadow */
  if controlShadow == 0 {
    .ytp-gradient-top, .ytp-gradient-bottom { display: none; }
  }

  /** Compact Menu */
  if compactMenu {
    tp-yt-paper-item.ytd-guide-entry-renderer { padding: 0 1px; }
    .title.ytd-mini-guide-entry-renderer { display: none; }
    ytd-mini-guide-entry-renderer, a.ytd-mini-guide-entry-renderer {
      border-radius: var(--button-corner-radius);
      width: 54px;
      padding: 14px 0 12px;
    }
  }

  /** Beta Features */
  if betaFeatures {
    .player-container.ytd-reel-video-renderer,
    .metadata-container.ytd-reel-player-overlay-renderer { border-radius: var(--feed-thumbnail-preview); }
    .ytPlayerProgressBarDragContainer, ytProgressBarLineProgressBarLine {
      margin-left: -8px; width: 81.6%; position: sticky;
    }
    .ytProgressBarLineProgressBarBackground,
    .ytProgressBarLineProgressBarPlayed,
    .ytProgressBarLineProgressBarLine,
    yt-progress-bar-playhead { width: 103.41%; }
    .ytProgressBarLineHost { width: 123.53%; }
    :root { --yt-spec-base-background: ytbgColor }
  }

  /** Remove Shorts */
  if removeShorts {
    ytd-rich-shelf-renderer[standard-shelf-margins][is-shorts],
    ytd-exploratory-results-renderer.ytd-item-section-renderer,
    ytd-horizontal-card-list-renderer.ytd-item-section-renderer:not(:first-child),
    ytd-rich-shelf-renderer[standard-shelf-margins] #dismissible.ytd-rich-shelf-renderer,
    ytd-reel-shelf-renderer.ytd-item-section-renderer {
      display: none !important;
      margin: 0; padding: 0;
    }
  }

  /** Panels & UI Tweaks */
  .page-header-view-model-wiz--display-as-sidebar .page-header-view-model-wiz__page-header-background,
  ytd-playlist-video-renderer, #description.ytd-watch-metadata,
  .immersive-header-container.ytd-playlist-header-renderer,
  ytd-comment-replies-renderer,
  ytd-comment-view-model,
  ytd-multi-page-menu-renderer,
  .yt-image-banner-view-model-wiz--inset {
    border-radius: var(--description-corner) !important;
  }
  
  ytd-comment-view-model { margin-top: 10px }

  
  ytd-watch-metadata[actions-on-separate-line] #actions.ytd-watch-metadata ytd-menu-renderer.ytd-watch-metadata {
    -moz-box-pack: end;
    justify-content: end;
  }

  #placeholder-area.ytd-comment-simplebox-renderer,
  .focused-line.tp-yt-paper-input-container { border-radius: 0; }

  a.yt-simple-endpoint.yt-formatted-string { color: var(--yt-spec-call-to-action) }
  #video-title.ytd-playlist-video-renderer { color: white }
  .yt-core-attributed-string__link--call-to-action-color,
  .yt-core-attributed-string--link-inherit-color .yt-core-attributed-string__link--call-to-action-color,
  .yt-spec-button-shape-next--call-to-action.yt-spec-button-shape-next--text,
  .yt-spec-button-shape-next--call-to-action.yt-spec-button-shape-next--outline {
    color: var(--button-des-text);
    background-color: transparent;
  }
  .yt-spec-touch-feedback-shape__fill, .yt-spec-touch-feedback-shape__stroke { 
      color: var(--button-des-text);  }
  /** Suggestions Grid */
  ytd-rich-item-renderer[rendered-from-rich-grid] {
    border-radius: var(--feed-thumbnail-preview);
    margin: 0 1.6px 1.2% 12px;
    box-shadow: 0 0 2px var(--yt-spec-static-grey);
  }
  ytd-rich-item-renderer[rendered-from-rich-grid][is-in-first-column] { margin-left: 10px; }

  /** Thumbnails & Player */
  .ytThumbnailViewModelLarge, .ytThumbnailViewModelMedium,
  .ytd-thumbnail, ytd-thumbnail[size="large"] a.ytd-thumbnail,
  ytd-thumbnail[size="large"]::before, ytd-thumbnail.ytd-rich-grid-media,
  ytd-playlist-thumbnail.ytd-rich-grid-media,
  ytd-watch-flexy[rounded-player] #ytd-player.ytd-watch-flexy,
  .collections-stack-wiz__collection-stack1--medium,
  .collections-stack-wiz__collection-stack1--large,
  .collections-stack-wiz__collection-stack2 {
    border-radius: var(--feed-thumbnail-preview) !important;
  }
  .html5-video-player, ytd-watch-flexy[rounded-player-large][default-layout] #ytd-player.ytd-watch-flexy,
  #card.ytd-miniplayer, #modern-card.ytd-miniplayer,
  .player-container.ytd-reel-video-renderer,
  .reel-video-in-sequence-thumbnail.ytd-shorts,
  .ytp-player-minimized .html5-main-video,
  .ytp-player-minimized .ytp-miniplayer-scrim {
    border-radius: var(--corner-radius-video-player);
  }
  
  .yt-lockup-metadata-view-model--compact .yt-lockup-metadata-view-model__title { margin-left: 10px }

  /** Progressbar */
  .ytProgressBarLinePlayerProgressBarLoaded,
  .ytProgressBarLineProgressBarHovered,
  .ytProgressBarLineProgressBarPlayed,
  .ytProgressBarLineProgressBarPlayedRefresh,
  .ytp-play-progress,
  ytd-thumbnail-overlay-resume-playback-renderer[enable-refresh-signature-moments-web] #progress.ytd-thumbnail-overlay-resume-playback-renderer {
    background: linear-gradient(to right, var(--progressbar-color-left) 80%, var(--progressbar-color-right) 100%);
  }
  .ytp-cairo-refresh .ytp-swatch-background-color { background-color: var(--progressbar-color-left) !important; }
  .ytp-scrubber-button, .ytProgressBarPlayheadProgressBarPlayheadDot, .ytp-swatch-background-color {
    background-color: var(--progressbar-color-right);
  }

  /** Buttons */
  .yt-spec-button-shape-next--size-m,
  #voice-search-button.ytd-masthead, .ytChipShapeChip,
  .yt-spec-button-shape-next--mono.yt-spec-button-shape-next--tonal {
    border: 0; color: var(--yt-spec-text-primary);
    background-color: var(--yt-emoji-picker-variant-selector-bg-color);
    border-radius: var(--button-corner-radius);
  }
  yt-interaction.circular .fill.yt-interaction { border-radius: var(--button-corner-radius) }
  .yt-spec-button-shape-next--mono.yt-spec-button-shape-next--text { color: var(--yt-spec-icon-disabled) }
  .yt-spec-touch-feedback-shape--touch-response .yt-spec-touch-feedback-shape__fill { 
      background-color: var(--yt-spec-outline-inverse-medium) !important;
      color: var(--yt-spec-text-primary) }
  .yt-spec-button-shape-next { background-color: transparent }
  .yt-spec-button-shape-next--overlay.yt-spec-button-shape-next--filled,
  #subscribe, #subscribe-button yt-button-shape button,
  #subscribe, #subscribe-button yt-button-shape a[aria-label="Subscribe"] {
    border-radius: var(--button-corner-radius);
    color: var(--yt-spec-static-brand-white) !important;
    background-color: var(--subscribe-button-color) !important;
  }
  #subscribe button[aria-label^="Unsubscribe"],
  #subscribe button.yt-spec-button-shape-next--tonal {
    border-radius: var(--button-corner-radius);
    color: var(--yt-spec-text-secondary) !important;
    background-color: var(--yt-spec-badge-chip-background) !important;
  }

  /** Searchbox */
  .ytSearchboxComponentInputBoxDark,
  .ytSearchboxComponentSearchButtonDark { border-radius: var(--search-box-radius) }
  .ytSearchboxComponentInputBoxDark.ytSearchboxComponentInputBoxHasFocus { border-color: var(--search-box-color) }
  .ytSuggestionComponentRemoveLinkDark { color: var(--search-box-color) }
}
